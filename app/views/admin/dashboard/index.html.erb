
<!-- Fond dégradé animé -->
<div class="absolute inset-0 -z-10 bg-gradient-to-tr from-[#FFB200]/30 via-white to-[#C8102E]/20 animate-gradient-x"></div>

<div class="mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
  <h1 class="text-3xl font-extrabold text-slate-900 tracking-tight flex items-center gap-3">
    <svg class="w-8 h-8 text-[#C8102E] animate-bounce" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
    Tableau de bord administrateur
  </h1>
  <div class="text-sm text-slate-600 bg-white/80 px-4 py-2 rounded-xl shadow flex items-center gap-2">
    <span class="font-semibold text-[#C8102E]">Aujourd'hui :</span>
    <%= Time.zone.now.strftime('%A %d %B %Y') %>
  </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
  <% cards = [
    { label: 'Drones', count: @drones_count, icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 18" stroke-width="1.5" stroke="currentColor" class="w-7 h-7"><path stroke-linecap="round" stroke-linejoin="round" d="M6.143 0H1.857A1.857 1.857 0 0 0 0 1.857v4.286C0 7.169.831 8 1.857 8h4.286A1.857 1.857 0 0 0 8 6.143V1.857A1.857 1.857 0 0 0 6.143 0Zm10 0h-4.286A1.857 1.857 0 0 0 10 1.857v4.286C10 7.169 10.831 8 11.857 8h4.286A1.857 1.857 0 0 0 18 6.143V1.857A1.857 1.857 0 0 0 16.143 0Zm-10 10H1.857A1.857 1.857 0 0 0 0 11.857v4.286C0 17.169.831 18 1.857 18h4.286A1.857 1.857 0 0 0 8 16.143v-4.286A1.857 1.857 0 0 0 6.143 10Zm10 0h-4.286A1.857 1.857 0 0 0 10 11.857v4.286c0 1.026.831 1.857 1.857 1.857h4.286A1.857 1.857 0 0 0 18 16.143v-4.286A1.857 1.857 0 0 0 16.143 10Z"/></svg>' },
    { label: 'Pilotes', count: @pilots_count, icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 18" stroke-width="1.5" stroke="currentColor" class="w-7 h-7"><path stroke-linecap="round" stroke-linejoin="round" d="M14 2a3.963 3.963 0 0 0-1.4.267 6.439 6.439 0 0 1-1.331 6.638A4 4 0 1 0 14 2Zm1 9h-1.264A6.957 6.957 0 0 1 15 15v2a2.97 2.97 0 0 1-.184 1H19a1 1 0 0 0 1-1v-1a5.006 5.006 0 0 0-5-5ZM6.5 9a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9ZM8 10H5a5.006 5.006 0 0 0-5 5v2a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-2a5.006 5.006 0 0 0-5-5Z"/></svg>' },
    { label: 'Vols', count: @voles_count, icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke-width="1.5" stroke="currentColor" class="w-7 h-7"><path stroke-linecap="round" stroke-linejoin="round" d="m17.418 3.623-.018-.008a6.713 6.713 0 0 0-2.4-.569V2h1a1 1 0 1 0 0-2h-2a1 1 0 0 0-1 1v2H9.89A6.977 6.977 0 0 1 12 8v5h-2V8A5 5 0 1 0 0 8v6a1 1 0 0 0 1 1h8v4a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-4h6a1 1 0 0 0 1-1V8a5 5 0 0 0-2.582-4.377ZM6 12H4a1 1 0 0 1 0-2h2a1 1 0 0 1 0 2Z"/></svg>' },
    { label: 'Observations', count: @observations_count, icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke-width="1.5" stroke="currentColor" class="w-7 h-7"><circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" fill="none"/><path d="M10 6v4l3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>' }
  ] %>
  <% cards.each do |card| %>
    <div class="bg-white p-6 rounded-2xl shadow-xl flex items-center group transition transform hover:-translate-y-1 hover:shadow-2xl border border-transparent hover:border-[#FFB200] relative overflow-hidden">
      <div class="h-12 w-12 flex items-center justify-center rounded-full bg-[#FFB200] text-white mr-4 shadow-lg group-hover:scale-110 transition-transform" >
        <%= raw card[:icon] %>
      </div>
      <div>
        <div class="text-slate-600 text-sm group-hover:text-[#FFB200] transition"> <%= card[:label] %> </div>
        <div class="text-3xl font-extrabold text-[#C8102E] group-hover:text-[#FFB200] transition"> <%= card[:count] %> </div>
      </div>
      <div class="absolute right-4 top-4 opacity-0 group-hover:opacity-100 transition text-xs text-[#FFB200] font-bold">+<%= rand(1..5) %> aujourd'hui</div>
    </div>
  <% end %>
</div>

<div class="bg-white rounded-2xl shadow p-6 mb-8">
  <h2 class="text-lg font-semibold text-slate-700 mb-4 flex items-center gap-2">
    <svg class="w-5 h-5 text-[#C8102E]" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm1 12H9v-2h2v2zm0-4H9V7h2v3z"/></svg>
    Évolution des vols par mois
  </h2>
  <%= line_chart @voles_per_month, height: '300px', library: {title: {text: ''}} %>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <div class="bg-gradient-to-br from-[#FFB200]/20 to-[#C8102E]/10 rounded-2xl p-6 shadow flex flex-col gap-2">
    <div class="text-lg font-bold text-slate-700 mb-2 flex items-center gap-2">
      <svg class="w-6 h-6 text-[#FFB200]" fill="currentColor" viewBox="0 0 24 24"><path d="M12 8v4l3 3"/></svg>
      Statistiques avancées
    </div>
    <div class="text-slate-700">Total vols ce mois : <span class="font-bold text-[#C8102E]"> <%= @voles_per_month.values.last %> </span></div>
    <div class="text-slate-700">Moyenne vols/mois : <span class="font-bold text-[#FFB200]"> <%= (@voles_per_month.values.sum / (@voles_per_month.size.nonzero? || 1)).round(1) %> </span></div>
    <div class="text-slate-700">Jour le plus actif : <span class="font-bold text-[#C8102E]"> <%= Vole.group_by_day(:created_at).count.max_by{|k,v| v}&.first&.strftime('%d/%m/%Y') || '-' %> </span></div>
  </div>
  <div class="bg-gradient-to-br from-[#C8102E]/20 to-[#FFB200]/10 rounded-2xl p-6 shadow flex flex-col gap-2">
    <div class="text-lg font-bold text-slate-700 mb-2 flex items-center gap-2">
      <svg class="w-6 h-6 text-[#C8102E]" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
      Résumé dynamique
    </div>
    <div class="text-slate-700">Nombre total d'utilisateurs : <span class="font-bold text-[#C8102E]"> <%= User.count %> </span></div>
    <div class="text-slate-700">Nombre total de drones : <span class="font-bold text-[#FFB200]"> <%= Drone.count %> </span></div>
    <div class="text-slate-700">Nombre total d'observations : <span class="font-bold text-[#C8102E]"> <%= Observation.count %> </span></div>
  </div>
</div>

<style>
@keyframes gradient-x {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}
.animate-gradient-x {
  background-size: 200% 200%;
  animation: gradient-x 8s ease-in-out infinite;
}
</style>
</div>
