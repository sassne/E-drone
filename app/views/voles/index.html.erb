

<div class="relative">
  <div class="absolute inset-0 -z-10 bg-gradient-to-tr from-[#FFB200]/20 via-white to-[#C8102E]/10 animate-gradient-x"></div>
  <div class="flex items-center justify-between mb-8">
    <div class="flex items-center gap-4">
      <svg class="w-10 h-10 text-[#C8102E] animate-bounce" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
      <h2 class="text-2xl font-extrabold text-slate-900 tracking-tight">Liste des vols</h2>
    </div>
    <%= link_to "Ajouter un vol", new_vole_path, class: "inline-block px-6 py-3 bg-[#C8102E] text-white text-base rounded-xl font-bold shadow hover:bg-[#FFB200] hover:text-[#C8102E] transition" %>
  </div>
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
    <div class="bg-white rounded-2xl shadow p-4 flex flex-col items-center group hover:shadow-2xl transition">
      <div class="text-[#C8102E] text-3xl font-extrabold"><%= @voles.count %></div>
      <div class="text-xs text-slate-600">Total vols</div>
    </div>
    <div class="bg-white rounded-2xl shadow p-4 flex flex-col items-center group hover:shadow-2xl transition">
      <div class="text-[#FFB200] text-3xl font-extrabold"><%= @voles.select { |v| v.land_at.present? }.count %></div>
      <div class="text-xs text-slate-600">Vols terminés</div>
    </div>
    <div class="bg-white rounded-2xl shadow p-4 flex flex-col items-center group hover:shadow-2xl transition">
      <div class="text-[#C8102E] text-3xl font-extrabold"><%= @voles.uniq { |v| v.drone_id }.count %></div>
      <div class="text-xs text-slate-600">Drones utilisés</div>
    </div>
    <div class="bg-white rounded-2xl shadow p-4 flex flex-col items-center group hover:shadow-2xl transition">
      <div class="text-[#FFB200] text-3xl font-extrabold"><%= @voles.uniq { |v| v.pilotes_details }.count %></div>
      <div class="text-xs text-slate-600">Pilotes différents</div>
    </div>
  </div>
  <div class="max-w-7xl mx-auto p-4">
    <%= turbo_frame_tag "filters" do %>
      <%= form_with url: voles_path, method: :get, data: { turbo_frame: "voles_list" }, class: "w-full flex flex-row gap-4 mb-6 items-end" do |f| %>
        <div class="my-0 field w-1/4">
          <%= f.label :start_date, "Date de début", class: "label text-sm text-slate-600 font-medium block mb-1" %>
          <%= f.date_field :start_date, value: params[:start_date], class: "input appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-[#FFB200]" %>
        </div>
        <div class="my-0 field w-1/4">
          <%= f.label :end_date, "Date de fin", class: "label text-sm text-slate-600 font-medium block mb-1" %>
          <%= f.date_field :end_date, value: params[:end_date], class: "input appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-[#FFB200]" %>
        </div>
        <div class="my-0 field w-1/4">
          <%= f.label :drone_name, "Nom", class: "label text-sm text-slate-600 font-medium block mb-1" %>
          <%= f.text_field :drone_name, value: params[:drone_name], class: "input appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-[#FFB200]" %>
        </div>
        <div class="flex flex-col justify-end w-1/4">
          <%= f.submit "Filtrer", class: "w-full py-3 px-4 text-sm font-semibold rounded-lg text-white bg-[#C8102E] hover:bg-[#FFB200] transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#FFB200]" %>
        </div>
      <% end %>
    <% end %>
    <%= turbo_frame_tag "voles_list" do %>
      <div class="overflow-x-auto rounded-2xl shadow-lg border border-gray-200">
        <table class="min-w-full table-auto">
          <thead class="align-middle bg-gray-200 text-sm text-left">
            <tr class="text-red-900">
              <th class="px-4 py-3">Drone</th>
              <th class="px-4 py-3">Décollé Le</th>
              <th class="px-4 py-3">Durée du vol</th>
              <th class="px-4 py-3">Type batterie</th>
              <th class="px-4 py-3">Pilotes</th>
              <th class="px-4 py-3">Remarque</th>
              <th class="px-4 py-3">Statut</th>
              <th class="px-4 py-3">Actions</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y">
            <% @voles.each do |vole| %>
              <tr class="text-slate-700 border-b border-gray-300 hover:text-[#FFB200] hover:bg-[#FFF7E6] transition">
                <td class="px-4 py-3 font-semibold">
                  <%= link_to vole.drone.nom, drone_path(vole.drone), class: "hover:text-primary" %>
                </td>
                <td class="px-4 py-3"><%= l vole&.date&.to_date, format: :long %></td>
                <td class="px-4 py-3"><%= pluralize(vole.duree_formatee, '') %></td>
                <td class="px-4 py-3"><%= vole.battery_type %></td>
                <td class="px-4 py-3"><%= vole.pilotes_details %></td>
                <td class="px-4 py-3"><%= vole.decorate.remarque_details %></td>
                <td class="px-4 py-3">
                  <% if vole.land_at.present? %>
                    <span class="text-green-600 font-bold">Terminé</span>
                  <% else %>
                    <span class="text-red-600 font-bold">En cours</span>
                  <% end %>
                </td>
                <td class="px-3 py-2">
                  <div class="flex space-x-2">
                    <%= link_to vole_path(vole), class: "inline-block px-4 py-2 bg-[#FFB200] text-white text-sm rounded-lg hover:bg-[#C8102E] transition font-bold" do %>
                      Voir
                    <% end %>
                    <%= link_to edit_vole_path(vole), class: "inline-block px-4 py-2 bg-[#C8102E] text-white text-sm rounded-lg hover:bg-[#FFB200] transition font-bold" do %>
                      Modifier
                    <% end %>
                    <%= button_to vole_path(vole), method: :delete, data: { turbo_confirm: "Êtes-vous sûr de vouloir supprimer ce vol ?" }, class: "inline-block px-4 py-2 bg-red-100 text-[#C8102E] text-sm rounded-lg hover:bg-[#FFB200] transition font-bold" do %>
                      Supprimer
                    <% end %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% end %>
  </div>
</div>

<!-- Tout le bloc ci-dessus est déjà correctement structuré, on supprime les duplicatas ci-dessous -->

<style>
@keyframes gradient-x {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}
.animate-gradient-x {
  background-size: 200% 200%;
  animation: gradient-x 8s ease-in-out infinite;
}
</style>
